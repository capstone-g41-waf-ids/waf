<!DOCTYPE html>
<html>
<head>
	<!-- meta info -->
	<meta charset="utf-8" />
	<meta name="description" content="Firewall page" />
	<meta name="keywords" content="Apply" />
	<meta name="author" content="Darcy" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<h2>WAF Portal</h2>

<nav class="nav1"><!-- nav menu -->
	<a href="serverstatus.html">Server Status</a>
	<a href="logsearch.html">Log Search</a>
	<a href="firewall.html">Firewall Settings</a>
	<div class="nav2">
		<a href="edituser.html">Edit user</a>
		<a href="{{url_for('logout')}}">Logout</a>
	</div>
</nav>

<!-- <include src="header.inc"></include> -->

<div><h1 >Log Search</h1></div>

<div class="main">
	<fieldset class="logs">
		<table id="myTable" style="table-layout: auto;">
			<tr>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="ip" readonly>
						<input type="text" name="searched" placeholder="IP Address">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="time_local" readonly>
						<input type="text" name="searched" placeholder="Time">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="http_referrer" readonly>
						<input type="text" name="searched" placeholder="HTTP Referrer">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="status" readonly>
						<input type="text" name="searched" placeholder="Status">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="request" readonly>
						<input type="text" name="searched" placeholder="Request">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="path" readonly>
						<input type="text" name="searched" placeholder="Path">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
				<th>
					<form action="{{url_for('search')}}" method="POST">
						<input type="hidden" name="field" value="user_agent" readonly>
						<input type="text" name="searched" placeholder="User Agent">
						<button type="submit"><i class="fa fa-search"></i></button>
					</form>
				</th>
			</tr>
			<tr>
				<th>IP Address</th>
				<th>Time</th>
				<th>HTTP referrer</th>
				<th>Status</th>
				<th>Request</th>
				<th>Path</th>
				<th>User_agent</th>
			</tr>
			{% for x in results %}
			<tr>
				<td>{{x["ip"]}}</td>
				<td>{{x["time_local"]}}</td>
				<td>{{x["http_referrer"]}}</td>
				<td>{{x["status"]}}</td>
				<td>{{x["request"]}}</td>
				<td>{{x["path"]}}</td>
				<td>{{x["user_agent"]}}</td>
			</tr>
			{% endfor %}
		</table>
	</fieldset>
	<fieldset class="logs">
		<table id="myTable" style="table-layout: fixed;">
			<thead>
				<tr>
					<th>
						<form action="{{url_for('auditlogsearch')}}" method="POST">
							<input type="text" name="searched" placeholder="Search">
							<button type="submit"><i class="fa fa-search"></i></button>
						</form>
					</th>
				</tr>
				<tr>
					<th>Mod security audit logs</th>
				</tr>
			</thead>
			<tbody>
					{% for x in results2 %}
					<tr>
						<td>{{x["log"]}}</td>
					</tr>
					{% endfor %}
			</tbody>
		</table>
	</fieldset>
</div>

</body>
</html>

